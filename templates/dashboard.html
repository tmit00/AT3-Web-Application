<!-- Template Inheritance -->
<!-- This template inherits from a base template called "base.html" -->
{% extends "base.html" %}

<!-- Block for the title of the page -->
{% block title %}Task List{% endblock %}

<!-- Block for the main content of the page -->
{% block content %} 

<div class="container">
    <!-- User Info and Stats -->
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:24px;">
        <div>
            <strong>Logged in as:</strong> {{ user.email }}
        </div>
        <div>
            <span style="font-weight:600; color:#43e97b;">
                You completed {{ pomodoros_today }} Pomodoros today!
            </span>
            <span style="margin-left:18px; color:#7b1fa2;">
                Total focus time: {{ focus_minutes_today }} minutes
            </span>
        </div>
    </div>

    <!-- Main heading for the Tasks page -->
    <h1>Tasks</h1>

    <!-- Button group for task actions -->
    <div class="button-group">
        <!-- Link to the "Add Task" page -->
        <a href="{{ url_for('todo_routes.create_task') }}" class="add-task-button">Add Task</a>
        
    </div>

    <!-- Table to display the list of tasks -->
    <table>
        <thead>
            <!-- Table header row defining the columns: Title, Description, Status, Due Date -->
            <tr>
                <th>Title</th>
                <th>Description</th>
                <th>Status</th>
                <th>Due Date</th>
                <th>Update Status</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            <!-- Loop through the tasks list passed from the backend and generate a row for each task -->
            {% for task in tasks %}
            <tr>
                <!-- Display task title -->
                <td>{{ task.title }}</td>
                <!-- Display task description -->
                <td>{{ task.description }}</td>
                <!-- Display task status: Complete or Incomplete -->
                <td class="{{ 'complete' if task.is_complete else 'incomplete' }}">
                    {{ 'Complete' if task.is_complete else 'Incomplete' }}
                </td>
                <!-- Display task date -->
                <td class="{% if task.is_overdue %}overdue{% else %}not-overdue{% endif %}">
                    {{ task.date }}</td>
                <td>
                    {% if not task.is_complete %}
                        <form action="{{ url_for('todo_routes.mark_complete', task_id=task.id) }}" method="post" style="display: inline;">
                            <button type="submit" class="mark-complete-button" onclick="return confirm('Mark task as complete?')">Mark Complete</button>
                        </form>
                    {% else %}
                        <form action="{{ url_for('todo_routes.mark_incomplete', task_id=task.id) }}" method="post" style="display: inline;">
                            <button type="submit" class="mark-incomplete-button" onclick="return confirm('Mark task as incomplete?')">Mark Incomplete</button>
                        </form>
                    {% endif %}
                </td>

                <td>
                    <form action="{{ url_for('todo_routes.delete', task_id=task.id) }}" method="post" style="display: inline;">
                        <button type="submit" class="delete-task-button" onclick="return confirm('Are you sure you want to delete this task?')">Delete Task</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}